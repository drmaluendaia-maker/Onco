<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guía de Práctica Clínica: Hematología y Oncología Pediátrica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f8fafc; --text-color: #1f2937; --card-bg: #ffffff;
            --header-bg: rgba(255, 255, 255, 0.8); --border-color: #e5e7eb;
            --primary-color: #3b82f6; --input-bg: #ffffff;
        }
        html.dark {
            --bg-color: #111827; --text-color: #d1d5db; --card-bg: #1f2937;
            --header-bg: rgba(31, 41, 55, 0.8); --border-color: #374151; --input-bg: #374151;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-color); }
        .bg-card { background-color: var(--card-bg); } .border-custom { border-color: var(--border-color); }
        .bg-header { background-color: var(--header-bg); } .input-custom { background-color: var(--input-bg); color: var(--text-color); border-color: var(--border-color); }
        ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: #f1f1f1; } html.dark ::-webkit-scrollbar-track { background: #2d3748; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; } ::-webkit-scrollbar-thumb:hover { background: #555; }
        details > summary { list-style: none; cursor: pointer; } details > summary::-webkit-details-marker { display: none; }
        details > summary::after { content: ' ▸'; float: right; transform: rotate(0deg); transition: transform 0.2s; } details[open] > summary::after { transform: rotate(90deg); }
        .tab-content { display: none; } .tab-content.active { display: block; }
        .tab-btn.active { border-bottom-color: var(--primary-color); color: var(--primary-color); font-weight: 600; }
        .calculator-card { background-color: #f3f4f6; border-left: 5px solid var(--primary-color); padding: 1.5rem; border-radius: 0.5rem; margin-top: 1rem; }
        html.dark .calculator-card { background-color: #2d3748; }
        .favorite-btn { cursor: pointer; opacity: 0.6; transition: all 0.2s; } .favorite-btn:hover { opacity: 1; transform: scale(1.1); } .favorite-btn.saved { color: #facc15; opacity: 1; }
        .highlight { background-color: #fef08a; border-radius: 3px; color: #1f2937; }
        #favorites-panel, #mobile-menu { background-color: var(--card-bg); transition: transform 0.3s ease-in-out; }
    </style>
</head>

<body>
    <header class="bg-header backdrop-blur-lg shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <a href="#inicio" class="text-xl font-bold text-blue-600">Guía Hemo-Onco Notti</a>
                <div class="hidden md:flex items-center space-x-4">
                    <a href="#calculadora-farmacos" class="text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Calculadora</a>
                    <a href="#debut-leucemico" class="text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Leucemia</a>
                    <a href="#neutropenia-febril" class="text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">N. Febril</a>
                    <a href="#lisis-tumoral" class="text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">SLT</a>
                    <a href="#anemia" class="text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Anemia</a>
                </div>
                <div class="flex items-center">
                    <button id="theme-toggle" class="text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400 mr-4 p-1 rounded-full"><svg id="theme-icon-light" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg><svg id="theme-icon-dark" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg></button>
                    <button id="favorites-toggle-btn" class="text-gray-600 hover:text-yellow-500 dark:text-gray-300 dark:hover:text-yellow-400 mr-4"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg></button>
                    <button id="mobile-menu-button" class="md:hidden text-gray-700 dark:text-gray-300 focus:outline-none"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg></button>
                </div>
            </div>
            <div id="mobile-menu" class="hidden md:hidden mt-3 border-t border-custom"><a href="#calculadora-farmacos" class="block py-2 text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Calculadora</a><a href="#debut-leucemico" class="block py-2 text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Leucemia</a><a href="#neutropenia-febril" class="block py-2 text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Neutropenia Febril</a><a href="#lisis-tumoral" class="block py-2 text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Síndrome de Lisis Tumoral</a><a href="#anemia" class="block py-2 text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Anemia</a><a href="#purpura" class="block py-2 text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400">Púrpura</a></div>
        </nav>
    </header>
    
    <div id="favorites-panel" class="fixed top-0 right-0 h-full w-80 shadow-2xl p-6 z-50 transform translate-x-full"><div class="flex justify-between items-center mb-4"><h2 class="text-xl font-bold">Acceso Rápido</h2><button id="close-favorites-btn" class="text-gray-500 hover:text-gray-800 dark:text-gray-300 text-3xl">&times;</button></div><div id="favorites-list" class="space-y-2 overflow-y-auto h-[calc(100%-4rem)]"></div></div>

    <main id="main-content" class="container mx-auto p-4 md:p-8">
        <section id="inicio" class="text-center pt-16 pb-12">
            <h1 class="text-3xl md:text-4xl font-bold mb-4">Guía de Práctica Clínica: Hematología y Oncología</h1>
            <h2 class="text-2xl md:text-3xl font-semibold text-blue-600 mb-6">Hospital Pediátrico Notti</h2>
            <div class="relative max-w-xl mx-auto my-8"><input type="search" id="global-search-input" placeholder="Buscar en toda la guía..." class="w-full pl-10 pr-4 py-2 border rounded-full input-custom focus:ring-blue-500 focus:border-blue-500"><svg class="w-5 h-5 text-gray-400 absolute top-1/2 left-4 -translate-y-1/2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-5xl mx-auto">
                <a href="#calculadora-farmacos" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Calculadora Farmacológica</h3></a>
                <a href="#debut-leucemico" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Debut Leucémico</h3></a>
                <a href="#neutropenia-febril" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Neutropenia Febril</h3></a>
                <a href="#lisis-tumoral" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Síndrome de Lisis Tumoral</h3></a>
                <a href="#anemia" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Anemia</h3></a>
                <a href="#purpura" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Púrpura y PTI</h3></a>
                <a href="#enterocolitis" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Enterocolitis Neutropénica</h3></a>
                <a href="#hemoderivados" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Hemoderivados</h3></a>
                <a href="#guia-pdf" class="bg-card p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300"><h3 class="text-xl font-semibold text-blue-700 dark:text-blue-400">Guía Completa en PDF</h3></a>
            </div>
        </section>

        <div class="space-y-12">
            
            <section id="calculadora-farmacos" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Calculadora Farmacológica Central</span><span class="favorite-btn" data-id="calculadora-farmacos" data-title="Calculadora Fármacos">★</span></h2>
                    <div class="calculator-card border-blue-500">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label for="drug-select" class="block text-sm font-medium mb-1">Seleccione un Fármaco</label>
                                <select id="drug-select" class="w-full p-2 border rounded input-custom">
                                    <option value="">-- Elija --</option>
                                    <option value="allopurinol">Alopurinol</option>
                                    <option value="ceftriaxona">Ceftriaxona</option>
                                    <option value="cefepime">Cefepime</option>
                                    <option value="piptazo">Piperacilina-Tazobactam</option>
                                    <option value="meropenem">Meropenem</option>
                                    <option value="vancomicina">Vancomicina</option>
                                    <option value="anfotericina">Anfotericina B Liposomal</option>
                                    <option value="voriconazol">Voriconazol</option>
                                    <option value="caspofungina">Caspofungina</option>
                                    <option value="prednisona_pti">Prednisona (PTI)</option>
                                    <option value="metilprednisolona_pti">Metilprednisolona (PTI)</option>
                                </select>
                            </div>
                            <div>
                                <label for="drug-weight" class="block text-sm font-medium mb-1">Peso (kg)</label>
                                <input type="number" id="drug-weight" placeholder="Ej: 15" class="w-full p-2 border rounded input-custom">
                            </div>
                            <div id="drug-height-container" class="hidden">
                                <label for="drug-height" class="block text-sm font-medium mb-1">Altura (cm)</label>
                                <input type="number" id="drug-height" placeholder="Ej: 100" class="w-full p-2 border rounded input-custom">
                            </div>
                        </div>
                        <button id="calculate-drug-btn" class="mt-4 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700">Calcular Dosis</button>
                        <div id="drug-result" class="mt-4 p-4 bg-blue-100 dark:bg-blue-900/50 rounded-md hidden"></div>
                    </div>
                </div>
            </section>

            <section id="debut-leucemico" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Debut Leucémico</span><span class="favorite-btn" data-id="debut-leucemico" data-title="Debut Leucémico">★</span></h2>
                    <div class="space-y-4"><p class="text-base">La leucemia es el cáncer más frecuente en la infancia (30% de las neoplasias), siendo la <strong>Leucemia Linfoblástica Aguda (LLA)</strong> el 80% de los casos y la <strong>Leucemia Mieloide Aguda (LMA)</strong> el 17%. La presentación clínica suele incluir afectación del estado general, síndrome anémico, diátesis hemorrágica, fiebre y dolor óseo. Los signos de alerta en el laboratorio son la afectación de dos o más series hematológicas, como anemia normocítica hiporregenerativa y trombocitopenia (<100.000/μl), junto con la posible presencia de blastos en sangre periférica, leucocitosis o leucopenia. El diagnóstico requiere >20% de blastos en médula ósea o sangre periférica.</p></div>
                </div>
            </section>

            <section id="neutropenia-febril" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Neutropenia Febril</span><span class="favorite-btn" data-id="neutropenia-febril" data-title="Neutropenia Febril">★</span></h2>
                    <div class="space-y-6">
                         <p class="text-base">La <strong>Neutropenia Febril (NF)</strong> es la complicación infecciosa más frecuente en pacientes oncológicos, definida por un Recuento Absoluto de Neutrófilos (RAN) ≤ 500/mm³ y temperatura axilar ≥ 38.5°C. Es crucial estratificar el riesgo: la <strong>NF de Alto Riesgo (NFAR)</strong> se asocia a LMA, recaída de LLA, hipotensión o PCR ≥ 90 mg/L. El manejo inicial debe ser inmediato, con toma de hemocultivos e inicio de antibioticoterapia empírica en la primera hora. El tratamiento para NFAR suele ser monoterapia con Cefepime o Piperacilina-Tazobactam, mientras que para la <strong>NF de Bajo Riesgo (NFBR)</strong> se puede usar Ceftriaxona.</p>
                        <details class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
                            <summary class="font-semibold text-lg text-blue-800 dark:text-blue-400">Herramientas Interactivas de NF</summary>
                            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="calculator-card border-blue-500"><h3 class="font-semibold">Algoritmo de Tratamiento Inicial</h3><div id="nf-step-1" class="mt-2"><p class="mb-2 text-sm">Paso 1: ¿Signos de sepsis/shock?</p><div class="flex space-x-4"><button onclick="handleNfAlgorithm('sepsis_yes')" class="flex-1 bg-red-500 text-white font-bold py-2 px-4 rounded hover:bg-red-600">Sí</button><button onclick="handleNfAlgorithm('sepsis_no')" class="flex-1 bg-gray-300 dark:bg-gray-600 py-2 px-4 rounded hover:bg-gray-400">No</button></div></div><div id="nf-step-2" class="hidden mt-2"><p class="mb-2 text-sm">Paso 2: ¿Criterios de Alto Riesgo (NFAR)?</p><div class="flex space-x-4"><button onclick="handleNfAlgorithm('nfar_yes')" class="flex-1 bg-orange-500 text-white font-bold py-2 px-4 rounded hover:bg-orange-600">Sí (NFAR)</button><button onclick="handleNfAlgorithm('nfar_no')" class="flex-1 bg-green-500 text-white font-bold py-2 px-4 rounded hover:bg-green-600">No (NFBR)</button></div></div><div id="nf-result" class="mt-4 p-3 bg-blue-100 dark:bg-blue-900/50 rounded-md text-center hidden"></div><button id="nf-reset-btn" onclick="resetNfAlgorithm()" class="mt-4 w-full text-sm text-blue-600 hover:underline hidden">Reiniciar</button></div>
                                <div class="calculator-card border-cyan-500"><h3 class="font-semibold">Manejo Infección de CVC</h3><div id="cvc-step-1" class="mt-2"><p class="mb-2 text-sm">Paso 1: ¿Infección complicada?</p><div class="flex space-x-4"><button onclick="handleCvcAlgorithm('comp_yes')" class="flex-1 bg-red-500 text-white font-bold py-2 px-4 rounded hover:bg-red-600">Sí</button><button onclick="handleCvcAlgorithm('comp_no')" class="flex-1 bg-gray-300 dark:bg-gray-600 py-2 px-4 rounded hover:bg-gray-400">No</button></div></div><div id="cvc-step-2" class="hidden mt-2"><p class="mb-2 text-sm">Paso 2: Microorganismo aislado</p><select id="cvc-microorganism" class="w-full p-2 border rounded input-custom"><option value="s_aureus">S. aureus / Pseudomonas / Candida</option><option value="other">Otro</option></select><button onclick="handleCvcAlgorithm('microbe_selected')" class="mt-3 w-full bg-cyan-600 text-white font-bold py-2 px-4 rounded hover:bg-cyan-700">Ver</button></div><div id="cvc-result" class="mt-4 p-3 bg-cyan-100 dark:bg-cyan-900/50 rounded-md text-center hidden"></div><button id="cvc-reset-btn" onclick="resetCvcAlgorithm()" class="mt-4 w-full text-sm text-cyan-600 hover:underline hidden">Reiniciar</button></div>
                            </div>
                        </details>
                    </div>
                </div>
            </section>
            
            <section id="lisis-tumoral" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Síndrome de Lisis Tumoral (SLT)</span><span class="favorite-btn" data-id="lisis-tumoral" data-title="Lisis Tumoral">★</span></h2>
                    <div class="space-y-6">
                        <p class="text-base">El <strong>Síndrome de Lisis Tumoral (SLT)</strong> es una emergencia oncológica causada por la destrucción masiva de células malignas, liberando su contenido y provocando <strong>hiperuricemia, hiperkalemia, e hiperfosfatemia</strong>, lo que conduce secundariamente a hipocalcemia y puede causar fallo renal agudo. El diagnóstico de SLT de laboratorio requiere 2 o más de los siguientes: Ácido Úrico ≥ 8 mg/dL, Potasio ≥ 6 mEq/L, o Fósforo ≥ 5 mEq/L. El manejo se basa en la <strong>hiperhidratación agresiva</strong> (3000 mL/m²/día) y el control de la uricemia con <strong>Alopurinol</strong> (riesgo bajo/moderado) o <strong>Rasburicase</strong> (riesgo alto).</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="calculator-card border-red-500"><h3 class="font-semibold">Calculadora de Riesgo de SLT</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2"><div><label class="text-sm">Tipo de Tumor</label><select id="slt-tumor-type" class="mt-1 block w-full p-2 border rounded input-custom"><option value="bajo">LMC</option><option value="moderado">LMA (25-100k)</option><option value="alto">Burkitt / LLA (≥100k)</option></select></div><div><label class="text-sm">LDH</label><select id="slt-ldh" class="mt-1 block w-full p-2 border rounded input-custom"><option value="normal">&lt; 2x LSN</option><option value="alto">≥ 2x LSN</option></select></div></div><button onclick="calculateTlsRisk()" class="mt-4 w-full bg-red-600 text-white font-bold py-2 px-4 rounded hover:bg-red-700">Calcular Riesgo</button><div id="slt-risk-result" class="mt-3 p-3 bg-red-100 dark:bg-red-900/50 rounded-md text-center hidden"></div></div>
                            <div class="calculator-card border-green-500"><h3 class="font-semibold">Calculadora de Hidratación</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2"><div><label class="text-sm">Peso (kg)</label><input type="number" id="bsa-weight" class="mt-1 block w-full p-2 border rounded input-custom"></div><div><label class="text-sm">Altura (cm)</label><input type="number" id="bsa-height" class="mt-1 block w-full p-2 border rounded input-custom"></div></div><button onclick="calculateBsaAndHydration()" class="mt-4 w-full bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700">Calcular</button><div id="bsa-result" class="mt-3 p-3 bg-green-100 dark:bg-green-900/50 rounded-md text-center hidden"></div></div>
                            <div class="calculator-card border-red-500"><h3 class="font-semibold">Calculadora de Hiperkalemia</h3><div class="mt-2"><label class="text-sm">Peso (kg)</label><input type="number" id="kalemia-weight" class="mt-1 block w-full p-2 border rounded input-custom"></div><button onclick="calculateHyperkalemia()" class="mt-4 w-full bg-red-600 text-white font-bold py-2 px-4 rounded hover:bg-red-700">Calcular Dosis</button><div id="kalemia-result" class="mt-3 p-3 bg-red-100 dark:bg-red-900/50 rounded-md hidden"></div></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="anemia" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Anemia</span><span class="favorite-btn" data-id="anemia" data-title="Anemia">★</span></h2>
                    <div class="space-y-6">
                        <p class="text-base">La <strong>Anemia</strong> se define como un nivel de hemoglobina por debajo de los valores de referencia para la edad y el sexo. En pediatría, la causa más frecuente a nivel mundial es la <strong>deficiencia de hierro (anemia ferropénica)</strong>, especialmente entre los 6 y 24 meses. Se clasifica morfológicamente según el VCM en <strong>microcítica</strong> (ferropenia, talasemias), <strong>normocítica</strong> (hemólisis, hemorragia aguda, enfermedad crónica) y <strong>macrocítica</strong> (déficit de ácido fólico/B12). La evaluación inicial se basa en el hemograma y los índices hematimétricos para orientar el diagnóstico.</p>
                        <details class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
                            <summary class="font-semibold text-lg text-blue-800 dark:text-blue-400">Herramientas para Anemia</summary>
                            <div class="mt-4 space-y-6">
                                <div class="calculator-card border-yellow-500"><h3 class="font-semibold">Dosis Hierro Parenteral</h3><div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-2"><div><label class="text-sm">Peso (kg)</label><input type="number" id="iron-weight" class="mt-1 w-full p-2 border rounded input-custom"></div><div><label class="text-sm">Hb Teórica</label><input type="number" id="iron-hb-target" class="mt-1 w-full p-2 border rounded input-custom" value="12"></div><div><label class="text-sm">Hb Real</label><input type="number" id="iron-hb-actual" class="mt-1 w-full p-2 border rounded input-custom"></div></div><button onclick="calculateIronDose()" class="mt-4 w-full bg-yellow-500 text-white font-bold py-2 px-4 rounded hover:bg-yellow-600">Calcular</button><div id="iron-result" class="mt-3 p-3 bg-yellow-100 dark:bg-yellow-900/50 rounded-md text-center hidden"></div></div>
                                <div class="calculator-card border-teal-500"><h3 class="font-semibold">Profilaxis de Hierro en Lactantes</h3><div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2"><div><label class="text-sm">Condición</label><select id="prophylaxis-condition" class="mt-1 w-full p-2 border rounded input-custom"><option value="term">RN Término</option><option value="preterm-1500-2000">RN Pretérmino (1.5-2kg)</option><option value="preterm-750-1500">RN Pretérmino (0.75-1.5kg)</option><option value="preterm-lt-750">RN Pretérmino (&lt;0.75kg)</option></select></div><div><label class="text-sm">Peso (kg)</label><input type="number" id="prophylaxis-weight" class="mt-1 w-full p-2 border rounded input-custom"></div></div><button onclick="calculateIronProphylaxis()" class="mt-4 w-full bg-teal-500 text-white font-bold py-2 px-4 rounded hover:bg-teal-600">Calcular</button><div id="prophylaxis-result" class="mt-3 p-3 bg-teal-100 dark:bg-teal-900/50 rounded-md text-center hidden"></div></div>
                                <div class="calculator-card border-cyan-500"><h3 class="font-semibold">Ayuda Dx Anemia Microcítica</h3><div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm"><div><label>Ferremia</label><select id="diff-ferremia" class="mt-1 w-full p-2 border rounded input-custom"><option value="D">Baja</option><option value="N">Normal</option><option value="A">Alta</option></select></div><div><label>Sat. Transferrina</label><select id="diff-saturation" class="mt-1 w-full p-2 border rounded input-custom"><option value="D">Baja</option><option value="N">Normal</option><option value="A">Alta</option></select></div><div><label>Ferritina</label><select id="diff-ferritin" class="mt-1 w-full p-2 border rounded input-custom"><option value="D">Baja</option><option value="N">Normal</option><option value="A">Alta</option></select></div><div><label>Hb A2</label><select id="diff-hba2" class="mt-1 w-full p-2 border rounded input-custom"><option value="N">Normal/Baja</option><option value="A">Alta</option></select></div></div><button onclick="diagnoseMicrocyticAnemia()" class="mt-4 w-full bg-cyan-600 text-white font-bold py-2 px-4 rounded hover:bg-cyan-700">Analizar</button><div id="differential-result" class="mt-3 p-3 bg-cyan-100 dark:bg-cyan-900/50 rounded-md text-center hidden"></div></div>
                            </div>
                        </details>
                    </div>
                </div>
            </section>
            
            <section id="purpura" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Púrpura y PTI</span><span class="favorite-btn" data-id="purpura" data-title="Púrpura y PTI">★</span></h2>
                    <div class="space-y-6">
                        <p class="text-base">La <strong>Púrpura Trombocitopénica Inmune (PTI)</strong> es la causa más común de sangrado adquirido en niños, caracterizada por trombocitopenia aislada (<100.000/μl) mediada por anticuerpos. Generalmente es un cuadro agudo y autolimitado, a menudo precedido por una infección viral. El diagnóstico es de exclusión, en un niño con buen estado general que presenta petequias y hematomas, sin hepatoesplenomegalia. El tratamiento de primera línea, si es necesario (plaquetas < 20.000/μl o sangrado significativo), incluye <strong>Corticoides</strong> o <strong>Inmunoglobulina IV</strong>.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="calculator-card border-indigo-500"><h3 class="font-semibold">Tratamiento PTI 1ª Línea</h3><div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2"><div><label class="text-sm">Peso (kg)</label><input type="number" id="pti-weight" class="mt-1 block w-full p-2 border rounded input-custom"></div><div><label class="text-sm">Fármaco</label><select id="pti-treatment" class="mt-1 block w-full p-2 border rounded input-custom"><option value="prednisona">Prednisona</option><option value="metilprednisolona">Metilprednisolona</option><option value="igiv">Ig IV</option></select></div></div><button onclick="calculatePtiDose()" class="mt-4 w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded hover:bg-indigo-700">Calcular Dosis</button><div id="pti-result" class="mt-3 p-3 bg-indigo-100 dark:bg-indigo-900/50 rounded-md text-center hidden"></div></div>
                            <div class="calculator-card border-cyan-500"><h3 class="font-semibold">Infusión de Gammaglobulina</h3><div class="mt-2"><label class="text-sm">Peso (kg)</label><input type="number" id="igiv-weight" class="mt-1 block w-full p-2 border rounded input-custom"></div><button onclick="calculateIgivInfusion()" class="mt-4 w-full bg-cyan-600 text-white font-bold py-2 px-4 rounded hover:bg-cyan-700">Generar Plan</button><div id="igiv-result" class="mt-3 p-3 bg-cyan-100 dark:bg-cyan-900/50 rounded-md hidden"></div></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="enterocolitis" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Enterocolitis Neutropénica</span><span class="favorite-btn" data-id="enterocolitis" data-title="Enterocolitis">★</span></h2>
                    <div class="space-y-4">
                        <p class="text-base">La <strong>Enterocolitis Neutropénica (tiflitis)</strong> es una inflamación necrotizante que afecta principalmente al ciego, siendo una complicación grave en pacientes con neutropenia profunda, especialmente con LMA o TPH. Se manifiesta con <strong>fiebre, dolor abdominal (usualmente en fosa ilíaca derecha) y diarrea</strong>. El diagnóstico se apoya en imágenes, donde la ecografía abdominal puede mostrar engrosamiento de la pared intestinal ≥3 mm. El manejo inicial consiste en <strong>reposo intestinal</strong> y cobertura antibiótica de amplio espectro contra bacilos gramnegativos y anaerobios, como <strong>Piperacilina-Tazobactam</strong> o un <strong>Carbapenem</strong>.</p>
                    </div>
                </div>
            </section>
            
            <section id="hemoderivados" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold border-b-4 border-blue-500 pb-3 mb-6 flex justify-between items-center"><span>Guía de Hemoderivados</span><span class="favorite-btn" data-id="hemoderivados" data-title="Hemoderivados">★</span></h2>
                    <div class="space-y-4">
                        <p class="text-base">La terapia transfusional busca reponer componentes sanguíneos específicos. La transfusión de <strong>Concentrados de Glóbulos Rojos (CGR)</strong> está indicada para mejorar el transporte de oxígeno, generalmente con un umbral de Hb < 7 g/dL en pacientes estables. La transfusión de <strong>Concentrados de Plaquetas (CP)</strong> se indica de forma profiláctica con recuentos < 10.000/μl en pacientes con insuficiencia medular o ante procedimientos invasivos con umbrales específicos (ej. >50.000/μl para cirugía mayor). La dosis habitual es 10-15 ml/kg para CGR y 1 unidad cada 10 kg para CP.</p>
                        <div class="calculator-card border-purple-500"><h3 class="font-semibold">Calculadora de Dosis de Transfusión</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2"><div><label class="text-sm">Peso (kg)</label><input type="number" id="trans-weight" class="mt-1 block w-full p-2 border rounded input-custom"></div><div><label class="text-sm">Componente</label><div class="mt-2 space-x-4"><label><input type="radio" name="component" value="rbc" checked> GR</label><label><input type="radio" name="component" value="platelets"> Plaquetas</label></div></div></div><button onclick="calculateTransfusion()" class="mt-4 w-full bg-purple-600 text-white font-bold py-2 px-4 rounded hover:bg-purple-700">Calcular Dosis</button><div id="transfusion-result" class="mt-3 p-3 bg-purple-100 dark:bg-purple-900/50 rounded-md text-center hidden"></div></div>
                    </div>
                </div>
            </section>

            <section id="guia-pdf" class="pt-20 -mt-20">
                <div class="bg-card p-6 md:p-8 rounded-2xl shadow-lg text-center">
                    <h2 class="text-2xl md:text-3xl font-bold mb-4">Guía Completa en PDF</h2>
                    <p class="mb-4">Para una referencia detallada, consulte el documento original.</p>
                    <a href="https://drive.google.com/file/d/1yL1qRgwMIV56bgpHFk1Mnbpa0NdwaeXN/view?usp=drive_link" target="_blank" rel="noopener noreferrer" class="inline-block bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors">Ver Guía en Línea</a>
                </div>
            </section>
        </div>
    </main>
<footer class="bg-gray-800 text-white mt-12"><div class="container mx-auto px-6 py-4 text-center"><p>&copy; 2024 Guía de Práctica Clínica Interactiva - Hospital Pediátrico Notti.</p><p class="text-xs text-gray-400 mt-1">Esta herramienta es una ayuda y no reemplaza el juicio clínico profesional.</p></div></footer>
<script>
    // --- ALL JS FUNCTIONS ---
    document.addEventListener('DOMContentLoaded', () => {
        setupTheme(); setupMobileMenu(); setupFavorites(); setupTabs();
        setupGlobalSearch(); attachCalculatorFunctions(); setupDrugCalculator();
    });

    const drugDb = {
        allopurinol: { name: 'Alopurinol', group: 'Antigotosos', dose: (w) => `Dosis diaria: <strong>${(10*w).toFixed(0)} mg</strong> (en 3 tomas).`, calculation: (w) => `Dosis (mg) = Peso (kg) × 10 mg/kg<br>= ${w} kg × 10 mg/kg = <strong>${(10*w).toFixed(0)} mg/día</strong>`},
        ceftriaxona: { name: 'Ceftriaxona', group: 'Cefalosporinas', dose: (w) => `Dosis diaria: <strong>${(100*w).toFixed(0)} mg</strong> (cada 24h).`, calculation: (w) => `Dosis (mg) = Peso (kg) × 100 mg/kg<br>= ${w} kg × 100 mg/kg = <strong>${(100*w).toFixed(0)} mg/día</strong>`},
        cefepime: { name: 'Cefepime', group: 'Cefalosporinas', dose: (w) => `Dosis diaria: <strong>${(100*w).toFixed(0)} mg</strong> (dividido c/8h).`, calculation: (w) => `Dosis total = ${w} kg × 100 mg/kg = ${(100*w).toFixed(0)} mg/día.<br>Administrar <strong>${((100*w)/3).toFixed(0)} mg</strong> cada 8 horas.`},
        piptazo: { name: 'Piperacilina-Tazobactam', group: 'Penicilinas', dose: (w) => `Dosis diaria: <strong>${(300*w).toFixed(0)} mg</strong> de Piperacilina (dividido c/6-8h).`, calculation: (w) => `Dosis total = ${w} kg × 300 mg/kg = <strong>${(300*w).toFixed(0)} mg/día</strong> de Piperacilina.`},
        meropenem: { name: 'Meropenem', group: 'Carbapenémicos', dose: (w) => `Dosis diaria: <strong>${(60*w).toFixed(0)} mg</strong> (dividido c/8h).<br><small>En BGN-KPC: hasta 120 mg/kg/día.</small>`, calculation: (w) => `Dosis total = ${w} kg × 60 mg/kg = ${(60*w).toFixed(0)} mg/día.<br>Administrar <strong>${((60*w)/3).toFixed(0)} mg</strong> cada 8 horas.`},
        vancomicina: { name: 'Vancomicina', group: 'Glicopéptidos', dose: (w) => `Dosis diaria: <strong>${(40*w).toFixed(0)} a ${(60*w).toFixed(0)} mg</strong> (dividido c/6h).`, calculation: (w) => `Rango diario: ${w} kg × (40-60) mg/kg = <strong>${(40*w).toFixed(0)}-${(60*w).toFixed(0)} mg/día</strong>.`},
        anfotericina: { name: 'Anfotericina B Liposomal', group: 'Antifúngicos', dose: (w) => `Dosis diaria: <strong>${(3*w).toFixed(0)} a ${(5*w).toFixed(0)} mg</strong>.`, calculation: (w) => `Rango diario: ${w} kg × (3-5) mg/kg = <strong>${(3*w).toFixed(0)}-${(5*w).toFixed(0)} mg/día</strong>.`},
        voriconazol: { name: 'Voriconazol', group: 'Antifúngicos', dose: (w) => `Dosis de Carga (2 dosis): <strong>${(9*w).toFixed(0)} mg/dosis</strong>.<br>Mantenimiento: <strong>${(8*w).toFixed(0)} mg/dosis</strong> (c/12h si >12a, c/8h si <12a).`, calculation: (w) => `Carga = ${w} kg × 9 mg/kg = <strong>${(9*w).toFixed(0)} mg/dosis</strong>.<br>Manto = ${w} kg × 8 mg/kg = <strong>${(8*w).toFixed(0)} mg/dosis</strong>.`},
        caspofungina: { name: 'Caspofungina', group: 'Antifúngicos', requiresHeight: true, dose: (w, h) => { const bsa = Math.sqrt((w*h)/3600); return `SC: <strong>${bsa.toFixed(2)} m²</strong><br>Dosis Carga: <strong>${Math.min(70, 70*bsa).toFixed(0)} mg</strong>.<br>Mantenimiento: <strong>${Math.min(50, 50*bsa).toFixed(0)} mg/día</strong>.` }, calculation: (w,h) => { const bsa = Math.sqrt((w*h)/3600); return `1. SC (m²) = √((Peso × Altura) / 3600)<br>= √((${w}×${h})/3600) = <strong>${bsa.toFixed(2)} m²</strong>.<br>2. Carga = SC × 70 mg/m² = <strong>${Math.min(70, 70*bsa).toFixed(0)} mg</strong> (Máx 70mg).<br>3. Manto = SC × 50 mg/m² = <strong>${Math.min(50, 50*bsa).toFixed(0)} mg</strong> (Máx 50mg).`}},
        prednisona_pti: { name: 'Prednisona', group: 'Corticoides', dose: (w) => `Dosis PTI: <strong>${Math.min(4*w, 180).toFixed(1)} mg/día</strong> (por 4 días).`, calculation: (w) => `Dosis = ${w} kg × 4 mg/kg = ${(4*w).toFixed(1)} mg.<br>Dosis final (máx 180mg): <strong>${Math.min(4*w, 180).toFixed(1)} mg/día</strong>.`},
        metilprednisolona_pti: { name: 'Metilprednisolona', group: 'Corticoides', dose: (w) => `Dosis PTI: <strong>${Math.min(30*w, 1000).toFixed(0)} mg/dosis</strong> (por 3 días).`, calculation: (w) => `Dosis = ${w} kg × 30 mg/kg = ${(30*w).toFixed(0)} mg.<br>Dosis final (máx 1g): <strong>${Math.min(30*w, 1000).toFixed(0)} mg/dosis</strong>.`},
    };

    function setupDrugCalculator() {
        const select = document.getElementById('drug-select');
        const heightContainer = document.getElementById('drug-height-container');
        const calculateBtn = document.getElementById('calculate-drug-btn');
        select.addEventListener('change', () => { heightContainer.classList.toggle('hidden', !drugDb[select.value]?.requiresHeight); });
        calculateBtn.addEventListener('click', () => {
            const drugKey = select.value, weight = parseFloat(document.getElementById('drug-weight').value), height = parseFloat(document.getElementById('drug-height').value), resultDiv = document.getElementById('drug-result');
            if (!drugKey || !weight || weight <= 0) { resultDiv.innerHTML = `<p class="text-red-600">Por favor, seleccione un fármaco e ingrese un peso válido.</p>`; resultDiv.classList.remove('hidden'); return; }
            const drug = drugDb[drugKey];
            if (drug.requiresHeight && (!height || height <= 0)) { resultDiv.innerHTML = `<p class="text-red-600">Este fármaco requiere peso y altura válidos.</p>`; resultDiv.classList.remove('hidden'); return; }
            const doseHtml = drug.dose(weight, height);
            const calcHtml = drug.calculation(weight, height);
            const nameUrl = `https://farmacia.garrahan.gov.ar/Vademecum/Busqueda?texto=${encodeURIComponent(drug.name)}`;
            const groupUrl = `https://farmacia.garrahan.gov.ar/Vademecum/BusquedaGrupoTerapeutico`;
            resultDiv.innerHTML = `<h4 class="font-bold text-lg">${drug.name}</h4><div class="mt-2">${doseHtml}</div>
                <details class="mt-3 text-sm"><summary class="font-semibold text-blue-600 cursor-pointer">Ver Cálculo</summary><div class="mt-2 p-2 bg-gray-200 dark:bg-gray-700 rounded">${calcHtml}</div></details>
                <div class="mt-4 text-sm flex space-x-4 border-t border-custom pt-3"><a href="${nameUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Vademecum (Nombre)</a><a href="${groupUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Vademecum (Grupo)</a></div>`;
            resultDiv.classList.remove('hidden');
        });
    }

    // --- ALL OTHER FUNCTIONS ---
    function attachCalculatorFunctions(){window.validateWeight=(t,e)=>{if(!t||t<=0)return e.innerHTML='<p class="text-red-600">Ingrese un peso válido.</p>',e.classList.remove("hidden"),!1;return!0},window.calculateTlsRisk=()=>{const t=document.getElementById("slt-risk-result"),e=document.getElementById("slt-ldh").value;let l=document.getElementById("slt-tumor-type").value;"alto"===e&&"moderado"===l&&(l="alto");let d="";"alto"===l?d='<span class="font-bold text-red-700">RIESGO ALTO.</span> Considerar Rasburicase.':"moderado"===l?d='<span class="font-bold text-orange-700">RIESGO MODERADO.</span> Iniciar Alopurinol.':d='<span class="font-bold text-green-700">RIESGO BAJO.</span> Monitoreo.',t.innerHTML=d,t.classList.remove("hidden")},window.calculateBsaAndHydration=()=>{const t=parseFloat(document.getElementById("bsa-weight").value),e=parseFloat(document.getElementById("bsa-height").value),l=document.getElementById("bsa-result");if(!t||!e||t<=0||e<=0)return l.innerHTML='<p class="text-red-600">Datos inválidos.</p>',l.classList.remove("hidden"),void 0;t<10?l.innerHTML=`<p class="font-bold">Hidratación: ${(200*t).toFixed(0)} ml/día</p>`:l.innerHTML=`<p>SC: <span class="font-bold">${Math.sqrt(t*e/3600).toFixed(2)} m²</span> | Hidratación: <span class="font-bold">${(3e3*Math.sqrt(t*e/3600)).toFixed(0)} ml/día</span></p>`,l.classList.remove("hidden")},window.calculateHyperkalemia=()=>{const t=parseFloat(document.getElementById("kalemia-weight").value),e=document.getElementById("kalemia-result");if(validateWeight(t,e)){e.innerHTML=`<ul class="text-sm space-y-1"><li><strong class="text-blue-700 dark:text-blue-400">Gluconato Ca 10%:</strong> ${(1.5*t).toFixed(1)} ml</li><li><strong class="text-blue-700 dark:text-blue-400">Sol. Polarizante:</strong> ${(0.75*t).toFixed(1)}g Glucosa + ${(0.075*t).toFixed(2)}U Insulina</li><li><strong class="text-blue-700 dark:text-blue-400">NaHCO3:</strong> ${(1.5*t).toFixed(1)} mEq</li></ul>`,e.classList.remove("hidden")}},window.calculateIronDose=()=>{const t=parseFloat(document.getElementById("iron-weight").value),e=parseFloat(document.getElementById("iron-hb-target").value),l=parseFloat(document.getElementById("iron-hb-actual").value),d=document.getElementById("iron-result");if(!t||!e||!l||t<=0)return d.innerHTML='<p class="text-red-600">Datos inválidos.</p>',d.classList.remove("hidden"),void 0;const n=(e-l)*.01*t*80*3.4*1.5;d.innerHTML=`Dosis total a reponer: <strong class="text-lg">${n.toFixed(0)} mg</strong>`,d.classList.remove("hidden")},window.calculateIronProphylaxis=()=>{const t=parseFloat(document.getElementById("prophylaxis-weight").value),e=document.getElementById("prophylaxis-result");if(validateWeight(t,e)){const l=document.getElementById("prophylaxis-condition").value,d={term:1,"preterm-1500-2000":2,"preterm-750-1500":3.5,"preterm-lt-750":5.5};e.innerHTML=`Dosis: <strong class="text-lg">${(d[l]*t).toFixed(1)} mg/día</strong> de Hierro elemental.`,e.classList.remove("hidden")}},window.diagnoseMicrocyticAnemia=()=>{const t=document.getElementById("diff-ferremia").value,e=document.getElementById("diff-saturation").value,l=document.getElementById("diff-ferritin").value,d=document.getElementById("diff-hba2").value,n=document.getElementById("differential-result");let i='<span class="font-bold">Patrón no concluyente.</span>';"D"===t&&"D"===e&&"D"===l?i='<span class="font-bold text-green-700">Orientación: Anemia Ferropénica.</span>':"N"===t&&"N"===e&&"N"===l&&"A"===d?i='<span class="font-bold text-blue-700">Orientación: Beta Talasemia.</span>':"D"===t&&"A"===l&&(i='<span class="font-bold text-orange-700">Orientación: Anemia de la Inflamación.</span>'),n.innerHTML=i,n.classList.remove("hidden")},window.calculatePtiDose=()=>{const t=parseFloat(document.getElementById("pti-weight").value),e=document.getElementById("pti-result");if(validateWeight(t,e)){const l=document.getElementById("pti-treatment").value;let d="";"prednisona"===l?d=`Prednisona: <strong>${Math.min(4*t,180).toFixed(1)} mg/día</strong> (4 días).`:"metilprednisolona"===l?d=`Metilprednisolona: <strong>${Math.min(30*t,1e3).toFixed(0)} mg/dosis</strong> (3 dosis).`:"igiv"===l&&(d=`Inmunoglobulina IV: <strong>${(1*t).toFixed(1)} g/día</strong> (1-2 días).`),e.innerHTML=d,e.classList.remove("hidden")}},window.calculateTransfusion=()=>{const t=parseFloat(document.getElementById("trans-weight").value),e=document.getElementById("transfusion-result");if(validateWeight(t,e)){e.innerHTML="rbc"===document.querySelector('input[name="component"]:checked').value?`Dosis GR: <strong class="text-lg">${(10*t).toFixed(0)} ml</strong> (10 ml/kg).`:`Dosis Plaquetas: <strong class="text-lg">${Math.round(t/10)} U</strong> (1U c/10 kg).`,e.classList.remove("hidden")}},window.calculateIgivInfusion=()=>{const t=parseFloat(document.getElementById("igiv-weight").value),e=document.getElementById("igiv-result");if(validateWeight(t,e)){const l=[.3,.6,1.2,2.4,4.8,6,7.2],d=["30","30","30","30","hasta finalizar","hasta finalizar","hasta finalizar"];let n='<h4 class="font-bold mb-2">Plan de Infusión Sugerido</h4><div class="overflow-x-auto"><table class="w-full text-sm text-left"><thead class="bg-gray-200 dark:bg-gray-600"><tr><th class="p-2">Intervalo (min)</th><th class="p-2">Velocidad (mL/kg/h)</th><th class="p-2">Velocidad (mL/hora)</th></tr></thead><tbody>`;l.forEach((t,e)=>{n+=`<tr class="border-b border-custom"><td class="p-2">${d[e]}</td><td class="p-2">${t}</td><td class="p-2 font-bold">${Math.min(t*w,150).toFixed(1)}</td></tr>`}),n+='</tbody></table></div><p class="text-xs mt-2 italic">Basado en plantilla Garrahan. Monitorear al paciente.</p>',e.innerHTML=n,e.classList.remove("hidden")}},window.handleNfAlgorithm=t=>{const e=document.getElementById("neutropenia-febril"),l=e.querySelector("#nf-step-1"),d=e.querySelector("#nf-step-2"),n=e.querySelector("#nf-result"),i=e.querySelector("#nf-reset-btn");let o="";l.classList.add("hidden"),"sepsis_yes"===t?o='<p class="font-bold text-red-700">Tratamiento:</p><p>Carbapenem + Vancomicina.</p>':"sepsis_no"===t?(d.classList.remove("hidden"),void 0):("nfar_yes"===t?(o='<p class="font-bold text-orange-700">Tratamiento (NFAR):</p><p>Cefepime o Pipe-Tazo.</p>',d.classList.add("hidden")):"nfar_no"===t&&(o='<p class="font-bold text-green-700">Tratamiento (NFBR):</p><p>Ceftriaxona o Cefotaxima.</p>',d.classList.add("hidden")),n.innerHTML=o,n.classList.remove("hidden"),i.classList.remove("hidden"))},window.resetNfAlgorithm=()=>{const t=document.getElementById("neutropenia-febril");t.querySelector("#nf-step-1").classList.remove("hidden"),t.querySelector("#nf-step-2").classList.add("hidden"),t.querySelector("#nf-result").classList.add("hidden"),t.querySelector("#nf-reset-btn").classList.add("hidden")},window.handleCvcAlgorithm=t=>{const e=document.getElementById("neutropenia-febril"),l=e.querySelector("#cvc-step-1"),d=e.querySelector("#cvc-step-2"),n=e.querySelector("#cvc-result"),i=e.querySelector("#cvc-reset-btn");let o="";l.classList.add("hidden"),"comp_yes"===t?o='<p class="font-bold text-red-700">Acción:</p><p>Remover CVC + Terapia Sistémica.</p>':"comp_no"===t?(d.classList.remove("hidden"),void 0):"microbe_selected"===t&&(o="s_aureus"===e.querySelector("#cvc-microorganism").value?'<p class="font-bold text-red-700">Acción:</p><p>Remover CVC + Terapia Sistémica.</p>':'<p class="font-bold text-green-700">Acción:</p><p>Terapia de Rescate (Sistémica + Sello).</p>',d.classList.add("hidden")),n.innerHTML=o,n.classList.remove("hidden"),i.classList.remove("hidden")},window.resetCvcAlgorithm=()=>{const t=document.getElementById("neutropenia-febril");t.querySelector("#cvc-step-1").classList.remove("hidden"),t.querySelector("#cvc-step-2").classList.add("hidden"),t.querySelector("#cvc-result").classList.add("hidden"),t.querySelector("#cvc-reset-btn").classList.add("hidden")}};
    function setupTheme(){const t=document.getElementById("theme-toggle"),e=document.getElementById("theme-icon-light"),l=document.getElementById("theme-icon-dark"),d=t=>{document.documentElement.classList.toggle("dark","dark"===t),e.classList.toggle("hidden","dark"===t),l.classList.toggle("hidden","dark"!==t)};let n=localStorage.getItem("theme")||"light";d(n),t.addEventListener("click",()=>{n="dark"===document.documentElement.classList.contains("dark")?"light":"dark",localStorage.setItem("theme",n),d(n)})}
    function setupMobileMenu(){document.getElementById("mobile-menu-button").addEventListener("click",()=>document.getElementById("mobile-menu").classList.toggle("hidden"))}
    function setupTabs(){document.querySelectorAll(".tab-btn").forEach(t=>t.addEventListener("click",()=>{const e=t.dataset.tab,l=t.closest(".bg-card");l.querySelectorAll(".tab-btn").forEach(t=>t.classList.remove("active")),t.classList.add("active"),l.querySelectorAll(".tab-content").forEach(t=>t.classList.toggle("active",t.id===`tab-content-${e}`))}))}
    function setupFavorites(){const t=document.getElementById("favorites-toggle-btn"),e=document.getElementById("close-favorites-btn"),l=document.getElementById("favorites-panel");t.addEventListener("click",()=>l.classList.remove("translate-x-full")),e.addEventListener("click",()=>l.classList.add("translate-x-full")),loadFavorites(),document.querySelectorAll(".favorite-btn").forEach(t=>t.addEventListener("click",e=>{e.stopPropagation(),toggleFavorite(t.dataset.id,t.dataset.title)}))}
    function getFavorites(){return JSON.parse(localStorage.getItem("hemoncoFavoritesV5"))||[]}
    function saveFavorites(t){localStorage.setItem("hemoncoFavoritesV5",JSON.stringify(t)),loadFavorites()}
    function toggleFavorite(t,e){let l=getFavorites(),d=l.findIndex(e=>e.id===t);d>-1?l.splice(d,1):l.push({id:t,title:e}),saveFavorites(l)}
    function loadFavorites(){const t=getFavorites();document.querySelectorAll(".favorite-btn").forEach(e=>e.classList.toggle("saved",t.some(t=>t.id===e.dataset.id)));const e=document.getElementById("favorites-list");if(0===t.length)return void(e.innerHTML='<p class="text-sm text-gray-500 dark:text-gray-400">Guarde secciones con ★ para verlas aquí.</p>');e.innerHTML=t.map(t=>`<a href="#${t.id}" class="block p-2 bg-gray-100 dark:bg-gray-700 rounded hover:bg-blue-100 dark:hover:bg-blue-900 transition-colors text-sm">${t.title}</a>`).join(""),e.querySelectorAll("a").forEach(t=>t.addEventListener("click",()=>document.getElementById("favorites-panel").classList.add("translate-x-full")))}
    function setupGlobalSearch(){const t=e=>{removeHighlights();if(!(e.length<3)){const l=new RegExp(e,"gi");d(document.getElementById("main-content"),l)}},d=(t,e)=>{3===t.nodeType?t.nodeValue.match(e)&&(const l=document.createElement("span");l.innerHTML=t.nodeValue.replace(e,t=>`<span class="highlight">${t}</span>`),t.parentNode.replaceChild(l,t)):1===t.nodeType&&t.childNodes&&!/script|style|svg/i.test(t.tagName)&&t.childNodes.forEach(t=>d(t,e))};document.getElementById("global-search-input").addEventListener("input",e=>t(e.target.value))}
    function removeHighlights(){document.querySelectorAll("span.highlight").forEach(t=>{const e=t.parentNode;e&&(e.replaceChild(document.createTextNode(t.textContent),t),e.normalize())})}
</script>

</body>
</html>
